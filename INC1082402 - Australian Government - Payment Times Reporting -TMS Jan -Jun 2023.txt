SELECT DISTINCT
apsa.VENDOR_SITE_CODE SUPPLIER_SITE,
nvl(aps.VAT_REGISTRATION_NUM,apsa.VAT_REGISTRATION_NUM) SUPPLIER_ABN,
--aps.VAT_REGISTRATION_NUM SUPPLIER_ABN,
--apsa.VAT_REGISTRATION_NUM SUPPLIER_ABN,
aps.VENDOR_NAME SUPPLIER_NAME,
aps.SEGMENT1 SUPPLIER_NUMBER,
aia.INVOICE_NUM INVOICE_NUMBER,
aia.INVOICE_AMOUNT INVOICE_VALUE,
aia.AMOUNT_PAID,
aia.CREATION_DATE INVOICE_CREATION_DATE,
aia.INVOICE_DATE,
aia.LAST_UPDATE_DATE INVOICE_PAID_DATE,
apt.NAME PO_TERMS
--apt.DESCRIPTION TERM_DESCRIPTION,
--pha.segment1 PO_NUMBER
--pha.creation_date,

FROM 
apps.po_headers_all pha,
apps.po_distributions_all pda,
apps.ap_invoice_distributions_all aid,
apps.ap_invoices_all aia,
apps.ap_terms apt,
apps.ap_suppliers aps,
apps.ap_supplier_sites_all apsa

WHERE pha.po_header_id=pda.po_header_id
AND aid.po_distribution_id=pda.po_distribution_id
AND aia.invoice_id=aid.invoice_id
AND apt.term_id =aia.terms_id
AND pha.org_id = 14474
AND trunc(pha.creation_date) between '01-JAN-23' AND '30-JUN-23'
AND aps.vendor_id = pha.vendor_id
AND apsa.vendor_site_id = pha.vendor_site_id
order by aps.SEGMENT1 desc
