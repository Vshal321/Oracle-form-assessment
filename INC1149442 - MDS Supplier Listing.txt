INC1149442 - MDS Supplier Listing

----------------------------------------------------------------------------------------------

SELECT DISTINCT
    hca.ACCOUNT_NUMBER,
    hp.party_name Customer_Name,
    bill_loc.address1 Bill_to_address1,
    bill_loc.address2 Bill_to_address2,
    bill_loc.address3 Bill_to_address3,
    bill_loc.city Bill_to_city,
    bill_loc.postal_code Bill_to_postal_code,
    bill_loc.country  Bill_to_Country,
    ship_loc.address1 Ship_to_address1,
    ship_loc.address2 Ship_to_address2,
    ship_loc.address3 Ship_to_address3,
    ship_loc.city Ship_to_city,
    ship_loc.postal_code Ship_to_postal_code,
    ship_loc.country Ship_to_country
FROM 
    apps.hz_parties hp,
    apps.hz_cust_accounts hca,
    apps.hz_cust_acct_sites_all hcasab,
    apps.hz_cust_acct_sites_all hcasas,
    apps.hz_cust_site_uses_all hzsuab,
    apps.hz_cust_site_uses_all hzsuas,
    apps.hz_party_sites hps,
    apps.hz_party_sites hpb,
    apps.hz_locations bill_loc,
    apps.hz_locations ship_loc,
    apps.hr_operating_units hou
WHERE 1 =1
AND hp.party_id             = hca.party_id
AND hcasab.cust_account_id  = hca.cust_account_id
AND hcasas.cust_account_id  = hca.cust_account_id
AND hpb.location_id         = bill_loc.location_id
AND hps.location_id         = ship_loc.location_id
AND hcasab.party_site_id    = hpb.party_site_id
AND hcasas.party_site_id    = hps.party_site_id
AND hcasab.cust_acct_site_id= hzsuab.cust_acct_site_id
AND hcasas.cust_acct_site_id= hzsuas.cust_acct_site_id
--AND hca.account_name='AFTERMARKET' --'MACHINES'
--AND hca.status = 'A'
--AND hp.status='A'
AND hzsuab.org_id = hou.organization_id
AND hzsuas.org_id = hou.organization_id
AND hou.organization_id IN (34270); -- for IE170 responsibility
/
alter session set nls_language='AMERICAN';
------------------------------------------------------------------------------------
SELECT DISTINCT aps.vendor_name supplier_name,
aps.segment1 supplier_number,
aps.vendor_type_lookup_code supplier_type,
aps.vat_registration_num "TAX REGISTRATION NUMBER",
trunc(aps.creation_date) "Supplier Creation Date",
(
SELECT
user_name
FROM
apps.fnd_user
WHERE
user_id = aps.created_by
) "Supplier Created By",
(
SELECT
MAX(aipa.accounting_date)
FROM
apps.ap_invoice_payments_all aipa,
apps.ap_invoices_all aia2
WHERE
aia2.vendor_id = aps.vendor_id
AND aia2.invoice_id = aipa.invoice_id
) last_payment_date,
apss.vendor_site_code "Site Name",
apss.address_line1
|| ' '
|| apss.address_line2
|| ' '
|| apss.address_line3
|| ' '
|| apss.city
|| ' '
|| apss.state
|| ' '
|| apss.county
|| ' '
|| apss.zip
|| ' '
|| apss.country "Supplier Address",
ft.territory_short_name "Supplier Country",
decode(sign(nvl(apss.inactive_date, sysdate + 1) - sysdate), - 1, 'Inactive', 'Active') site_status,
(
SELECT
name
FROM
apps.ap_terms_tl
WHERE
term_id = apss.terms_id
AND language = 'US'
) "Payment Terms",
decode(sign(nvl(pc.inactive_date, sysdate + 1) - sysdate), - 1, 'Inactive', 'Active') contact_status,
pc.first_name || pc.last_Name "Contact Name",
pc.email_address "CONTACT EMAIL"
FROM
apps.ap_suppliers aps,
--apps.hz_parties hpc,
apps.ap_supplier_sites_all apss,
apps.ap_tolerance_templates att,
apps.po_vendor_contacts pc,
apps.fnd_territories_vl ft,
(
SELECT
bankacct.bank_account_name bank_account_name,
bankacct.bank_account_number bank_account_number,
pmtins.order_of_preference primary_flag,
bankacct.currency_code currency_bank_acc,
pmtins.start_date start_date,
pmtins.end_date end_date,
pvs.vendor_site_id,
payee.org_id
FROM
apps.iby_ext_bank_accounts_v bankacct,
apps.ap_supplier_sites pvs,
apps.iby_external_payees_all payee,
apps.iby_pmt_instr_uses_all pmtins
WHERE
1 = 1
AND bankacct.ext_bank_account_id = pmtins.instrument_id
-- AND pmtins.payment_flow = 'DISBURSEMENTS'
AND pmtins.instrument_type = 'BANKACCOUNT'
AND pmtins.ext_pmt_party_id = payee.ext_payee_id
AND payee.supplier_site_id = pvs.vendor_site_id
AND nvl(payee.party_site_id, - 99) = nvl(pvs.party_site_id, - 99)
AND payee.org_id = pvs.org_id
AND pvs.org_id = 34270
) bank_det
WHERE
aps.vendor_id = apss.vendor_id
AND apss.vendor_site_id = bank_det.vendor_site_id (+)
AND apss.country = ft.territory_code (+)
AND apss.org_id = 34270
AND apss.org_id = bank_det.org_id (+)
AND apss.tolerance_id = att.tolerance_id (+)
AND apss.vendor_site_id = pc.vendor_site_id (+)
AND aps.vendor_id = pc.vendor_id (+);
--AND rownum = 1;
/
select * from org_organization_definitions where OPERATING_UNIT = '34270'; --in ('','','',)
/
alter session set nls_language='AMERICAN'; 